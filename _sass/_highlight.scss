// Terminal-style code blocks with window chrome
// Includes terminal buttons, title bar, and copy functionality

pre span {
  line-height: 1.6rem;
  font-family: "JetBrains Mono", "Fira Code", "Monaco", "Consolas", monospace;
}

// Terminal window wrapper (added by JS)
.terminal-window {
  @include center(rem(800px));
  margin: rem(20px) auto;
  padding: 0 rem(20px);
  position: relative;

  @include media(">=sm") {
    margin: rem(29px) auto;
    padding: 0;
  }

  // Linux-style terminal title bar
  .terminal-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    background: #1a1a1a;
    border: 1px solid $terminal-green;
    border-bottom: none;
    border-radius: 0;
    padding: rem(6px) rem(12px);
  }

  // Linux terminal prompt
  .terminal-prompt {
    display: flex;
    align-items: center;
    font-family: "JetBrains Mono", "Fira Code", monospace;
    font-size: rem(13px);
    color: #888888;

    &::before {
      content: "user@linux";
      color: $terminal-cyan;
    }

    &::after {
      content: ":~$";
      color: #888888;
    }
  }

  // Copy button - now part of header flex
  .terminal-copy {
    background: rgba($terminal-green, 0.1);
    border: 1px solid $terminal-green;
    color: $terminal-green;
    padding: rem(3px) rem(10px);
    font-size: rem(11px);
    cursor: pointer;
    border-radius: 0;
    @include mainFont(400);
    transition: all 0.2s ease;
    margin-left: rem(15px);

    &:hover {
      background: $terminal-green;
      color: $terminal-bg;
    }

    &.copied {
      background: $terminal-green;
      color: $terminal-bg;
    }
  }

  // The actual code block
  pre {
    overflow-x: auto;
    background-color: #0a0a0a;
    border: 1px solid $terminal-green;
    border-top: none;
    border-radius: 0;
    padding: rem(30px) rem(35px);
    margin: 0;
    position: relative;

    code {
      display: block;
      background: transparent;
      border: none;
      padding: 0;
      font-size: rem(13px);
      line-height: 1.7;
      color: $texts;
      font-family: "JetBrains Mono", "Fira Code", "Monaco", "Consolas", monospace;
      white-space: pre;
      overflow-x: auto;

      @include media(">=sm") {
        font-size: rem(14px);
      }
    }
  }
}

// Legacy .highlight wrapper (Rouge syntax highlighting)
.highlight {
  @include center(rem(800px));
  margin: rem(20px) auto;
  padding: 0 rem(20px);

  @include media(">=sm") {
    word-wrap: break-word;
    margin: rem(29px) auto;
    padding: 0;
  }

  // When wrapped in terminal-window, remove extra margins
  .terminal-window & {
    margin: 0;
    padding: 0;
    max-width: none;
  }

  pre {
    overflow-x: auto;
    background-color: #0a0a0a;
    border: 1px solid $terminal-green;
    border-radius: 0;
    padding: rem(30px) rem(35px) !important;
    margin: 0;
    position: relative;

    // When inside terminal-window, adjust styling
    .terminal-window & {
      border-top: none;
      padding: rem(30px) rem(35px) !important;
    }

    code {
      display: block;
      background: transparent;
      border: none;
      padding: 0;
      font-size: rem(13px);
      line-height: 1.7;
      color: $texts;
      font-family: "JetBrains Mono", "Fira Code", "Monaco", "Consolas", monospace;
      white-space: pre;
      overflow-x: auto;

      @include media(">=sm") {
        font-size: rem(14px);
      }
    }
  }

  .hll {
    background-color: rgba($terminal-green, 0.1);
  }

  // Syntax highlighting colors
  .c,     // Comment
  .cm,    // Comment.Multiline
  .cp,    // Comment.Preproc
  .c1,    // Comment.Single
  .cs {   // Comment.Special
    color: #6a737d;
    font-style: italic;
  }

  .err {  // Error
    color: $terminal-red;
    background-color: rgba($terminal-red, 0.1);
  }

  .kc,    // Keyword.Constant
  .kp,    // Keyword.Pseudo
  .kr,    // Keyword.Reserved
  .kt,    // Keyword.Type
  .no {   // Name.Constant
    color: $terminal-cyan;
  }

  .l,     // Literal
  .mf,    // Literal.Number.Float
  .mh,    // Literal.Number.Hex
  .mi,    // Literal.Number.Integer
  .mo,    // Literal.Number.Oct
  .se,    // Literal.String.Escape
  .il {   // Literal.Number.Integer.Long
    color: #bd93f9;
  }

  .p,     // Punctuation
  .nx {   // Name.Other
    color: #b0b0b0;
  }

  .ni,    // Name.Entity
  .nn,    // Name.Namespace
  .py,    // Name.Property
  .nv,    // Name.Variable
  .w,     // Text.Whitespace
  .bp,    // Name.Builtin.Pseudo
  .vc,    // Name.Variable.Class
  .vg,    // Name.Variable.Global
  .vi {   // Name.Variable.Instance
    color: $terminal-green;
  }

  .nl {   // Name.Label
    color: $terminal-cyan;
  }

  .n,     // Name
  .nb,    // Name.Builtin
  .m {    // Literal.Number
    color: #bd93f9;
  }

  .nt,    // Name.Tag
  .k,     // Keyword
  .kn,    // Keyword.Namespace
  .kd,    // Keyword.Declaration
  .o,     // Operator
  .ow {   // Operator.Word
    color: #ff79c6;
  }

  .ge {   // Generic.Emph
    font-style: italic;
  }

  .gs {   // Generic.Strong
    font-weight: bold;
  }

  .ld,     // Literal.Date
  .s,      // Literal.String
  .sb,     // Literal.String.Backtick
  .sc,     // Literal.String.Char
  .sd,     // Literal.String.Doc
  .s2,     // Literal.String.Double
  .sh,     // Literal.String.Heredoc
  .si,     // Literal.String.Interpol
  .sx,     // Literal.String.Other
  .sr,     // Literal.String.Regex
  .s1,     // Literal.String.Single
  .ss,     // Literal.String.Symbol
  .vglnk { // Link
    color: $terminal-amber;
  }

  .na,    // Name.Attribute
  .nc,    // Name.Class
  .nd,    // Name.Decorator
  .ne,    // Name.Exception
  .nf {   // Name.Function
    color: $terminal-green;
    text-shadow: 0 0 3px rgba($terminal-green, 0.3);
  }
}
